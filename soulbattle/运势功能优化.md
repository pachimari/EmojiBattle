# 运势功能优化

## 1. 概述

运势功能目前仅限于控制每天的属性上限和带入。基于 S1 的实际体验，我们发现在抽卡时抽到被动，且被动会高稀有度覆盖低稀有度这一设计存在问题。

因此在 S2 中，我们计划：

1. 移除抽卡中的所有被动卡牌，使抽卡只会获得主动卡牌
2. 将被动卡牌迁移至每日运势系统中
3. 每日运势将为全服玩家提供：
   - X张（预计3张）相同属性、相同稀有度的被动卡牌（运势卡牌）
   - Y张（预计1张）专属随机被动卡牌

这些被动卡牌包含增益和减益效果，将为所有玩家创造一个统一的全局战场环境。在这种环境下，某些将领的BD（Build）会有更好的发挥空间，从而增加将领BD与策略的多样性。

## 2. 界面设计

| 模块 | 名称 | 具体说明 |
| --- | --- | --- |
| 1 | 今日运势 | 今日运势处不变 |
| 2 | 运势卡牌 | 鼠标移到运势卡牌上显示tooltips介绍运势卡牌的作用 | 下方显示3张全服的运势卡牌 |
| 3 | 个人运势 | 鼠标移到个人上显示tooltips介绍运势卡牌的作用 | 下方显示独属于个人的运势卡牌 |
| 4 | 卡牌坑 | 包括图片与名称 | 鼠标移到上面卡牌的模版上面显示通用卡牌tips模版 |
| 5 | 宝箱位置 | 把进度条去掉，宝箱移到右上方 | 上面是宝箱图片，下面是今日次数，最多为3 | 如果宝箱有未领取的内容，则为打开状态，点亮 | 如果宝箱已领取或不用领取，则为关闭状态 | 鼠标移到该区域tooltips介绍宝箱的规则 |

## 3. 规则说明

### 3.1 配置调整

- 移除所有 `appear_type=1`（抽卡）且 `user_type=2`（被动）的卡牌
- 新增两种类型用于区分全服运势卡牌与个人运势卡牌
- 这两种卡牌均设定为被动类型

如此一来，实际对局中不会存在可以抽取的被动卡牌，全为系统发放，包括将领的个人被动，将领的全局被动，阵营被动，全局运势被动与个人运势被动

#### 更新机制

- 运势卡牌在每天更新运势时对全服玩家统一更新

#### 全服运势

1. 每次更新时，系统从全服运势卡牌池中按 weight 抽取三张
2. 按 40:30:20:10 的权重抽取稀有度
3. 进入游戏后，这三张运势卡牌以被动形式赋予三名武将

#### 个人运势

1. 每次更新时，系统从个人运势卡牌池中按 weight 抽取一张
2. 按 40:30:20:10 的权重抽取稀有度（考虑公平性，可能不配置稀有度）
3. 每位玩家每天都会重新随机抽取

### 3.3 概率补偿机制（待评估）

建议实现动态随机机制：

- 已获得卡牌的概率动态降低
- 未获得卡牌的概率动态提高
- 保持总体期望平衡

主要应用场景：

1. 个人运势系统中特殊强力卡牌的获取
2. 确保玩家在赛季周期内至少获得一次
3. 优化轮空、闪避等纯随机机制，使其更符合玩家体感

再按40:30:20:10的权重抽取其稀有度（不过出于公平考虑，可能不会配置稀有度）

个人运势每个人每天都会重新在池子里随机

其他规则

概率补偿（看下好不好做，不止这个地方）

可能比较难实现，比如在拿取卡牌时，做动态随机，拿过的卡牌概率降低，未拿的卡牌概率提高，总期望上保持相对平衡

这个地方主要是想给个人运势做，比如个人运势可能会给设计一个特别吊的卡牌，但是概率会低，但是又尽量能让每个玩家在一个赛季周期内刷到一次

包括玩家说得比较多的轮空纯随机、各种闪避率纯随机都会出现不符合体感的情况，如果在这个中间做伪随机，但是最终结果符合分布与体感，可能会更好一点
